You are fixing a failed analytics translation output.

Input schema_json:
{schema}

Input sample_rows_json:
{sample}

Question:
{question}

Previous output JSON:
{previous_output}

Execution error log:
{error_log}

Return strict valid JSON only:
{{
  "answer": "short analytic answer",
  "pandas_query": "optional pandas query expression string or null",
  "chart_config": {{
    "type": "bar|line|pie|histogram",
    "x": "column name",
    "y": "column name or null",
    "aggregation": "sum|mean|count|max|min|null"
  }}
}}

Rules:
- Use only existing columns.
- Keep query safe and simple.
- Fix according to error log.
- No markdown or code fences.
- IMPORTANT: answer must be in Russian.
